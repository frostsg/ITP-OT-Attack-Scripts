from pymodbus.client import ModbusTcpClient

# Define the IP and port of the Modbus server
ip_address = '192.168.30.3'
port = 502

# Coil addresses to be manipulated
coil_address_1 = 0
coil_address_2 = 1

# Initialize the Modbus TCP client
client = ModbusTcpClient(ip_address, port)

while True:
    # Connect to the Modbus server
    if client.connect():
        
        # Write value to the first coil (True to turn it on)
        response_1 = client.write_coil(coil_address_1, False)
        if response_1.isError():
            print(f"Error writing to coil at address {coil_address_1}")
        else:
            print(f"Coil value at address {coil_address_1} successfully altered to False")

        # Write value to the second coil (True to turn it on)
        response_2 = client.write_coil(coil_address_2, True)
        if response_2.isError():
            print(f"Error writing to coil at address {coil_address_2}")
        else:
            print(f"Coil value at address {coil_address_2} successfully altered to True")
        
    else:
        print("Unable to connect to the Modbus server")
